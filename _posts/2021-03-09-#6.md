---
layout: post
title: 改进的有效边表填充算法实现
date: 2021-03-09
author: Lian
---

这里不仔细讲原理，只是把我写的算法发出来，跟大家分享下，如果有错误的话，还请大家告诉我，如果写的不好，也请指出来，一起讨论进步。

边表构造的算法:

(1) 首先构造一个纵向链表，链表的长度为多边形所占有的最大扫描线数，链表的每个结点，称为一个桶，则对应多边形覆盖的每一条扫描线。

(2) 将每条边的信息链入与该边最小y坐标相对的桶处。也就是说，若某条边的较低点为ymin，则该边就放在相应的扫描线中。

(3) 每条边的数据形成一个结点，内容包括:该扫描线与该的初始交点x(即较低端点的x值),1/k，以及该边的最大y值ymax如下：
x|ymin　　ymax　　1/k 　　next

(4) 同一桶中若干条边按x|ymin由小到在大排序，若x|ymin相等，则按照1/k由小到大排序。

改进的有效边表填充算法步骤如下:

(1) 初始化： 构造边表， AET表置空.

(2) 将第一个不空的ET表中的边与AET表合并。

(3) 删除AET表中y = ymax的边后再填充，按“下闭上升”的原则进行填充，此时就无需缩短任何边。然后进行填充，填充时设置一个布尔量b(初值为假)，令指针从有效边表中第一个结点到最后一个结点进行遍历一次。每访问一个结点，把b取反一次，若b为真，则把从当前结点的x值开始下一结点的x值结束的区间用多边形色填充。(填充时需要对x坐标进行四舍五入处理)。

(4) yi+1 = yi + 1,根据xi+1 = xi + 1 / k计算并修改AET表，同时合并ET表中y = yi+1桶的边，按次序插入到AET表中，形成新的AET表。

(5) AET表不空则转(3)，否则结束。
